<div class="container py-4">

  <div class="d-flex flex-column flex-lg-row justify-content-between align-items-lg-end mb-4 mb-lg-5">

    <div class="mb-3 mb-lg-0">
      <h2 class="fw-bold text-nowrap">Available Job Openings</h2>
      <p class="text-muted mb-0">
        Showing {{ paginatedJobs.length }} of {{ jobs.length }} total jobs
      </p>
    </div>

    <div class="d-flex align-items-center gap-3 justify-content-end w-100 w-lg-auto"> 
      <!-- View toggle (keeps card view unchanged) -->
      <div class="me-2">
        <div class="btn-group" role="group" aria-label="View mode">
          <button type="button" class="btn btn-sm" [class.active]="viewMode === 'card'" (click)="setView('card')" [attr.aria-pressed]="viewMode === 'card'" title="Card View">
            <i class="bi bi-grid-3x3-gap-fill"></i>
          </button>
          <button type="button" class="btn btn-sm" [class.active]="viewMode === 'list'" (click)="setView('list')" [attr.aria-pressed]="viewMode === 'list'" title="List View">
            <i class="bi bi-list-ul"></i>
          </button>
        </div>
      </div>

      <div class="position-relative w-100" style="max-width: 600px;"> 
        <input 
          type="text" 
          class="form-control form-control-lg rounded-pill ps-5 pe-5 border-2" 
          placeholder="Search job titles, companies"
          [(ngModel)]="searchText"
          
          (input)="filterJobs()"
        >
        
        <i 
          class="bi bi-search position-absolute top-50 start-0 translate-middle-y ms-3 fs-5" 
          style="color: var(--primary-color);"
        ></i>
        
        <button 
          *ngIf="searchText"
          class="btn btn-link position-absolute top-50 end-0 translate-middle-y me-3 p-0"
          (click)="clearSearch()"
          title="Clear Search"
        >
          <i class="bi bi-x-circle-fill fs-5 text-muted"></i>
        </button>
      </div>

    <button 
  class="btn border-0 p-0 d-flex align-items-center justify-content-center"
  style="background: transparent;"
  title="Toggle Bookmarked Jobs Filter"
  (click)="toggleBookmarkFilter()"
>
  <i 
    class="{{ showBookmarksOnly ? 'bi-bookmark-fill' : 'bi-bookmark' }}
           fs-5 d-flex align-items-center justify-content-center rounded-circle"
    style="
      width: 38px; 
      height: 38px;
      transition: 0.3s ease;
    "

    [style.border]="showBookmarksOnly 
                      ? '3px solid var(--primary-color)' 
                      : '2px solid var(--primary-color)'"

    [style.color]="showBookmarksOnly 
                      ? 'var(--primary-color)' 
                      : 'var(--primary-color)'"
  ></i>
</button>


    </div>

  </div>
  
  



  <!-- Responsive Job Grid -->
  <!-- shared template for job details (title/company/tags/location) -->
  <ng-template #jobDetails let-job>
    <div>
      <h5 class="card-title fw-bold mb-1 text-dark">{{ job.title }}</h5>
      <p class="text-muted small mb-2">{{ job.company_name }}</p>
      <div class="d-flex flex-wrap gap-1">
        <span class="badge bg-light text-dark border rounded-pill px-2 py-1 small">{{ job.job_type }}</span>
        
      </div>
      <p class="text-secondary small mb-0 mt-2"><i class="bi bi-geo-alt-fill me-1"></i>{{ job.candidate_required_location }}</p>
    </div>
  </ng-template>

  <!-- Card Grid (preserved original layout) -->
  <div *ngIf="viewMode === 'card'" class="row g-4">
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4" *ngFor="let job of paginatedJobs">
      <div class="card h-100 shadow-sm border-0 rounded-4">
        <div class="card-body d-flex flex-column">
          <!-- Title + Bookmark -->
          <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
              <ng-container *ngTemplateOutlet="jobDetails; context: {$implicit: job}"></ng-container>
            </div>
            <i class="{{ isBookmarked(job.id) ? 'bi-bookmark-fill' : 'bi-bookmark' }} fs-4" style="cursor: pointer; color: var(--primary-color);" (click)="toggleBookmark(job.id)"></i>
          </div>

          <!-- Apply Button aligned to right with oval shape -->
          <div class="mt-auto d-flex justify-content-end">
            <a [routerLink]="['/jobs', job.id]" class="btn fw-semibold rounded-pill apply-btn">Apply Now</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- List / Row View (reuses jobDetails template) -->
  <div *ngIf="viewMode === 'list'" class="list-group">
    <div class="list-group-item d-flex align-items-center" *ngFor="let job of paginatedJobs">
      <div class="flex-grow-1">
        <ng-container *ngTemplateOutlet="jobDetails; context: {$implicit: job}"></ng-container>
      </div>
      <div class="d-flex align-items-center gap-3 ms-3">
        <a [routerLink]="['/jobs', job.id]" class="btn btn-sm apply-btn">Apply Now</a>
        <i class="{{ isBookmarked(job.id) ? 'bi-bookmark-fill' : 'bi-bookmark' }} fs-4" style="cursor: pointer; color: var(--primary-color);" (click)="toggleBookmark(job.id)"></i>
      </div>
    </div>
  </div>

  <!-- Pagination -->
 <nav class="d-flex justify-content-center mt-5">
  <ul class="pagination pagination-sm" style="gap: 8px;">

    <!-- Previous -->
    <li class="page-item" [class.disabled]="page === 1">
      <button 
        class="page-link"
        style="
          background: none;
          border: none;
          color: var(--primary-color);
          padding: 4px 6px;
          box-shadow: none;
        "
        (click)="prevPage()"
      >
        <i class="bi bi-chevron-left"></i>
      </button>
    </li>

    <!-- Page Numbers -->
    <li 
      class="page-item"
      *ngFor="let p of totalPagesArray"
      [class.active]="p === page"
    >
      <button 
        class="page-link"
        (click)="goToPage(p)"
        style="
          background: none;
          border: none;
          padding: 4px 6px;
          box-shadow: none;
          font-weight: 500;
          color: var(--primary-color);
        "
        [style.fontWeight]="p === page ? '700' : '500'"
        [style.textDecoration]="p === page ? 'underline' : 'none'"
      >
        {{ p }}
      </button>
    </li>

    <!-- Next -->
    <li class="page-item" [class.disabled]="page === totalPages">
      <button 
        class="page-link"
        style="
          background: none;
          border: none;
          color: var(--primary-color);
          padding: 4px 6px;
          box-shadow: none;
        "
        (click)="nextPage()"
      >
        <i class="bi bi-chevron-right"></i>
      </button>
    </li>

  </ul>
</nav>



</div>
